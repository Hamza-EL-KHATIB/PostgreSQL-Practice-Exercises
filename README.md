# **PostgreSQL Practice Exercises**

## Beginner

- [x] List all movies in the ‘Action’ category.
```
SELECT f.title AS movies
FROM film AS f
JOIN film_category fc on f.film_id = fc.film_id
JOIN category c on c.category_id = fc.category_id
WHERE  c.name = 'Action';
```
- [x] Find all customers who have spent more than $100.
```
SELECT concat(c.first_name, ' ', c.last_name) AS name
FROM customer AS c
JOIN payment AS p ON c.customer_id = p.customer_id
GROUP BY c.customer_id
HAVING SUM(p.amount) > 100
```
- [x] Find all movies that actor 'Kevin Bloom' has acted in.
```
SELECT f.title
FROM film f
INNER JOIN film_actor fa on f.film_id = fa.film_id
INNER JOIN actor a on a.actor_id = fa.actor_id
WHERE a.first_name = 'Kevin' AND a.last_name = 'Bloom';
```
- [x] List all the actors who have appeared in more than 20 movies.
```
SELECT a.first_name, a.last_name, COUNT(fa.film_id) as film_count
FROM actor a
INNER JOIN film_actor fa on a.actor_id = fa.actor_id
GROUP BY a.actor_id
HAVING COUNT(fa.film_id) > 20;
```
- [x] List all the customers who have rented a movie more than once in a single day.
```
SELECT first_name, last_name, COUNT(r.rental_id)
FROM customer AS c
INNER JOIN rental AS r ON r.customer_id = c.customer_id
GROUP BY c.customer_id, r.rental_date
HAVING COUNT(rental_date) > 1
```
- [x] List all the movies that have not been rented yet.
```
SELECT f.title
FROM film f
LEFT JOIN inventory i ON f.film_id = i.film_id
LEFT JOIN rental r ON i.inventory_id = r.inventory_id
WHERE r.rental_date IS NULL;
```
- [ ] List all the customers who have rented a movie in the ‘Action’ category but not in the ‘Comedy’ category.
```
```
- [ ] List all the movies that have been rented more than 50 times.
```
```
- [ ] List all the movies that have been rented by a customer who has a first name starting with ‘J’.
```
```
- [ ] List all the movies that have been rented more than once by the same customer.
```
```
- [ ] List all the movies that were released in 2006.
```
```
- [ ] Find all customers who live in the same city as the ‘Sakila’ store.
```
```
- [ ] List all the languages available in the database.
```
```
- [ ] Find all movies that are longer than 2 hours.
```
```
- [ ] List all the categories available in the database.
```
```
- [ ] Find all movies that are rated ‘PG-13’.
```
```
- [ ] List all the stores and their addresses.
```
```
- [ ] Find all customers who have a last name that starts with ‘A’.
```
```
- [ ] List all the films that have ‘Love’ in their title.
```
```
- [ ] Find all movies that were rented in the last 7 days.
```
```

## Intermediate

- [ ] Find the most popular movie (the movie that has been rented the most).
```
```
- [ ] Find the total sales by store.
```
```
- [ ] Find the top 5 customers who have rented the most movies.
```
```
- [ ] Find the average rental duration for each movie category.
```
```
- [ ] Find the total revenue generated by each movie category.
```
```
- [ ] Find the top 10 most rented movies in the ‘Drama’ category.
```
```
- [ ] Find the average rental duration for each store.
```
```
- [ ] Find the customers who have rented the most number of movies in each city.
```
```
- [ ] Find the total number of rentals for each customer.
```
```
- [ ] Find the total number of movies in each category.
```
```
- [ ] Find the most rented movie in each category.
```
```
- [ ] Find the total sales by each customer.
```
```
- [ ] Find the top 5 most rented movies of all time.
```
```
- [ ] Find the total number of rentals for each movie.
```
```
- [ ] List all customers who have rented a movie in both ‘Action’ and ‘Comedy’ categories.
```
```
- [ ] Find the total revenue generated by each store in 2006.
```
```
- [ ] List all actors who have acted in a ‘Science Fiction’ movie.
```
```
- [ ] Find the top 5 customers who have spent the most on rentals.
```
```
- [ ] Find the total number of rentals made by each staff member.
```
```

## Advanced

- [ ] Find the top 5 most profitable movies.
```
```
- [ ] List all the customers who have rented a movie in the ‘Family’ category but not in the ‘Children’ category.
```
```
- [ ] Find the average rental duration for each actor.
```
```
- [ ] List all the movies that have been rented by a customer who lives in a city with a population greater than 500,000.
```
```
- [ ] Find the customers who have rented the most number of movies in each country.
```
```
- [ ] Write a query to find the top 5 most rented movies in each language, along with the number of times each movie has been rented.
```
```
- [ ] Write a query to find the top 5 most profitable movies in each language, along with the total revenue generated by each movie.
```
```
- [ ] Write a query to find the top 5 most profitable actors, along with the total revenue generated by each actor.
```
```
- [ ] Write a query to find the top 5 most profitable categories, along with the total revenue generated by each category, for each year.
```
```
- [ ] Write a query to find the top 5 customers who have rented the most number of movies in each city, along with the total number of movies rented by each customer.
```
```
- [ ] Find the total revenue generated by each actor.
```
```
- [ ] Find the top 5 actors who have acted in the most number of films.
```
```
- [ ] Write a query to find the top 5 most rented movies in each rating, along with the number of times each movie has been rented.
```
```
- [ ] Write a query to find the top 5 most profitable movies in each rating, along with the total revenue generated by each movie.
```
```
- [ ] Write a query to find the top 5 most profitable languages, along with the total revenue generated by each language.
```
```
- [ ] Write a query to find the top 5 most profitable ratings, along with the total revenue generated by each rating.
```
```
- [ ] Write a query to find the top 5 customers who have rented the most number of movies in each rating, along with the total number of movies rented by each customer.
```
```
- [ ] Write a query to find the top 5 customers who have rented the most number of movies in each language, along with the total number of movies rented by each customer.
```
```
- [ ] Write a query to find out which actor’s films have been rented out by customers from different cities.
```
```
- [ ] Write a query to find out which category of films is most popular among customers from different countries.
```
```

## Expert

- [ ] Write a query to find the top 5 most rented movies in each category, along with the number of times each movie has been rented.
```
```
- [ ] Write a query to find the top 5 most profitable movies in each category, along with the total revenue generated by each movie.
```
```
- [ ] Write a query to find the top 5 most profitable stores, along with the total revenue generated by each store.
```
```
- [ ] Write a query to find the top 5 most profitable cities, along with the total revenue generated by each city.
```
```
- [ ] Write a query to find out which month had the highest number of rentals for each year.
```
```
- [ ] Write a query to find out which actor’s films have been rented out by customers from different countries.
```
```
- [ ] Write a query to find out which category of films is most popular among customers from different cities.
```
```
- [ ] Write a query to find out which store has generated more revenue from comedy films than action films.
```
```
- [ ] Write a query to find out which country has generated more revenue from drama films than comedy films.
```
```
- [ ] Write a query to find out which month had the highest number of rentals for each category.
```
```
- [ ] Write a query to find out which actor’s films have been rented out by customers from different countries.
```
```
- [ ] Write a query to find out which category of films is most popular among customers from different cities.
```
```
- [ ] Write a query to find out which store has generated more revenue from comedy films than action films.
```
```
- [ ] Write a query to find out which country has generated more revenue from drama films than comedy films.
```
```
- [ ] Write a query to find out which actor’s films have been rented out by customers from different countries.
```
```
- [ ] Write a query to find out which category of films is most popular among customers from different countries.
```
```
- [ ] Write a query to find out which store has generated more revenue from comedy films than action films.
```
```
- [ ] Write a query to find out which country has generated more revenue from drama films than comedy films.
```
```
- [ ] Write a query to find out which actor’s films have been rented out by customers from different countries.
```
```